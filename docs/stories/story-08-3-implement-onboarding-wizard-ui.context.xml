<?xml version="1.0" encoding="UTF-8"?>
<story-context>
  <metadata>
    <story-id>08.3</story-id>
    <story-title>Implement Onboarding Wizard UI</story-title>
    <epic>EPIC-08 - Business Onboarding &amp; Foundation Modules</epic>
    <priority>P0 - Critical</priority>
    <points>5</points>
    <dependencies>
      <dependency>Story 08.1 - Business database models</dependency>
      <dependency>Story 08.2 - Portfolio dashboard</dependency>
      <dependency>EPIC-07 - UI Shell (layout components)</dependency>
    </dependencies>
    <generated>2025-12-04</generated>
  </metadata>

  <story-summary>
    <user-story>
      As a user
      I want a guided onboarding wizard
      So that I can start a new business with clear steps
    </user-story>

    <overview>
      This story implements a 4-step wizard that guides users through creating a new business in HYVVE.
      The wizard captures essential business information, offers document upload vs. fresh start paths,
      and persists state to localStorage for resume functionality. On completion, it creates a Business
      record and navigates to the appropriate next step based on the user's chosen path.
    </overview>

    <key-features>
      <feature>Multi-step wizard with progress indicator (4 steps)</feature>
      <feature>Step 1: Choice between "I have documents" and "Start from scratch"</feature>
      <feature>Step 2: Business name and description capture with validation</feature>
      <feature>Step 3: Initial idea capture (problem, target customer, solution)</feature>
      <feature>Step 4: Review and confirmation with edit capability</feature>
      <feature>State persistence to localStorage (resume after abandonment)</feature>
      <feature>Real-time form validation with Zod schemas</feature>
      <feature>Character count displays for text fields</feature>
      <feature>Navigation between steps with data preservation</feature>
      <feature>Business creation API call on completion</feature>
    </key-features>
  </story-summary>

  <acceptance-criteria>
    <criterion id="AC-08.3.1">
      <title>Multi-Step Wizard Component</title>
      <requirements>
        <requirement>Wizard displays 4 distinct steps with progress indicator</requirement>
        <requirement>Progress indicator shows current step (e.g., "Step 1/4")</requirement>
        <requirement>Visual progress bar or stepper component shows completion</requirement>
        <requirement>Each step can be validated independently before proceeding</requirement>
        <requirement>Wizard follows existing UI patterns from Epic 07</requirement>
      </requirements>
    </criterion>

    <criterion id="AC-08.3.2">
      <title>Step 1 - Document Upload vs Fresh Start Choice</title>
      <requirements>
        <requirement>Step 1 presents two clear options: "I have existing documents" and "Start from scratch"</requirement>
        <requirement>Each option has descriptive text explaining what happens next</requirement>
        <requirement>Cards are visually distinct (icon, border, hover state)</requirement>
        <requirement>Selection stores choice in wizard state</requirement>
        <requirement>Continue button navigates to Step 2</requirement>
      </requirements>
    </criterion>

    <criterion id="AC-08.3.3">
      <title>Step 2 - Business Name and Description</title>
      <requirements>
        <requirement>Form captures business name (required, max 100 chars)</requirement>
        <requirement>Form captures business description (required, max 500 chars, textarea)</requirement>
        <requirement>Real-time validation with error messages</requirement>
        <requirement>Character count displayed for description field</requirement>
        <requirement>"Back" button returns to Step 1 (preserves previous selections)</requirement>
        <requirement>"Continue" button validates and proceeds to Step 3</requirement>
        <requirement>Form validation uses Zod schema</requirement>
      </requirements>
      <validation-rules>
        <rule>Business name: Required, 3-100 characters, no special characters except spaces and hyphens</rule>
        <rule>Description: Required, 10-500 characters</rule>
      </validation-rules>
    </criterion>

    <criterion id="AC-08.3.4">
      <title>Step 3 - Initial Idea Capture</title>
      <requirements>
        <requirement>Captures problem statement (required, textarea, max 300 chars)</requirement>
        <requirement>Captures target customer (required, text input, max 200 chars)</requirement>
        <requirement>Captures proposed solution (required, textarea, max 300 chars)</requirement>
        <requirement>Each field has helper text explaining what to enter</requirement>
        <requirement>Real-time validation with character counts</requirement>
        <requirement>"Back" button returns to Step 2 (preserves data)</requirement>
        <requirement>"Continue" button validates and proceeds to Step 4</requirement>
      </requirements>
    </criterion>

    <criterion id="AC-08.3.5">
      <title>Step 4 - Confirmation and Launch</title>
      <requirements>
        <requirement>Displays summary of all entered information</requirement>
        <requirement>Each section has "Edit" button to jump back to that step</requirement>
        <requirement>"Back" button returns to Step 3</requirement>
        <requirement>"Launch Business" button creates business record and navigates to next step</requirement>
        <requirement>Loading state during business creation</requirement>
        <requirement>Error handling for failed creation</requirement>
      </requirements>
    </criterion>

    <criterion id="AC-08.3.6">
      <title>Progress Indicator</title>
      <requirements>
        <requirement>Progress indicator always visible at top of wizard</requirement>
        <requirement>Shows current step number (e.g., "Step 2/4")</requirement>
        <requirement>Visual stepper shows completed, current, and upcoming steps</requirement>
        <requirement>Step labels: "Choice", "Details", "Idea", "Launch"</requirement>
        <requirement>Clicking completed steps allows navigation back (preserves data)</requirement>
      </requirements>
    </criterion>

    <criterion id="AC-08.3.7">
      <title>Navigation Between Steps</title>
      <requirements>
        <requirement>"Back" button visible on steps 2-4</requirement>
        <requirement>"Continue" button validates current step before proceeding</requirement>
        <requirement>Keyboard navigation supported (Enter to continue)</requirement>
        <requirement>Browser back button works correctly (no data loss)</requirement>
        <requirement>URL parameter reflects current step (e.g., /onboarding/wizard?step=2)</requirement>
      </requirements>
    </criterion>

    <criterion id="AC-08.3.8">
      <title>Persist Wizard State (Resume if Abandoned)</title>
      <requirements>
        <requirement>Wizard state saved to localStorage on each step change</requirement>
        <requirement>If user abandons wizard, state is preserved</requirement>
        <requirement>Returning to wizard resumes from last completed step</requirement>
        <requirement>"Start Over" option available to clear saved state</requirement>
        <requirement>Saved state includes all form data and current step</requirement>
        <requirement>State expires after 7 days</requirement>
      </requirements>
    </criterion>

    <criterion id="AC-08.3.9">
      <title>Create Business Record on Completion</title>
      <requirements>
        <requirement>On "Launch Business" click, API call creates Business record</requirement>
        <requirement>Business record includes workspaceId, userId, name, description from wizard</requirement>
        <requirement>Business record includes onboardingStatus: VALIDATION (or WIZARD if upload path)</requirement>
        <requirement>Business record includes stage: IDEA (default)</requirement>
        <requirement>ValidationSession record created with ideaDescription populated</requirement>
        <requirement>Success: Navigate to /onboarding/documents if hasDocuments=true</requirement>
        <requirement>Success: Navigate to /dashboard/[id]/validation if hasDocuments=false</requirement>
        <requirement>Error: Display error message, allow retry</requirement>
        <requirement>Loading state prevents duplicate submissions</requirement>
      </requirements>
    </criterion>
  </acceptance-criteria>

  <existing-patterns>
    <ui-patterns>
      <pattern name="Card Component">
        <description>shadcn/ui Card with Header, Title, Description, Content, Footer</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/ui/card.tsx</location>
        <example><![CDATA[
import { Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter } from '@/components/ui/card'

<Card className="cursor-pointer border-2 transition-all hover:border-primary">
  <CardHeader>
    <CardTitle>Title</CardTitle>
    <CardDescription>Description</CardDescription>
  </CardHeader>
  <CardContent>
    {/* Content */}
  </CardContent>
  <CardFooter>
    {/* Footer */}
  </CardFooter>
</Card>
        ]]></example>
      </pattern>

      <pattern name="Button Component">
        <description>shadcn/ui Button with variants and sizes</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/ui/button.tsx</location>
        <example><![CDATA[
import { Button } from '@/components/ui/button'

<Button variant="default" size="lg" disabled={isLoading}>
  {isLoading ? <Loader2 className="mr-2 h-4 w-4 animate-spin" /> : null}
  Submit
</Button>

// Variants: default, destructive, outline, secondary, ghost, link
// Sizes: default, sm, lg, icon
        ]]></example>
      </pattern>

      <pattern name="Form Inputs">
        <description>shadcn/ui Input and Textarea components</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/ui/input.tsx</location>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/ui/textarea.tsx</location>
        <example><![CDATA[
import { Input } from '@/components/ui/input'
import { Textarea } from '@/components/ui/textarea'
import { Label } from '@/components/ui/label'

<div className="space-y-2">
  <Label htmlFor="field">Field Name</Label>
  <Input
    id="field"
    type="text"
    placeholder="Enter text"
    {...register('field')}
    disabled={isSubmitting}
    aria-invalid={errors.field ? 'true' : 'false'}
  />
  {errors.field && (
    <p className="text-sm text-red-600">{errors.field.message}</p>
  )}
</div>
        ]]></example>
      </pattern>

      <pattern name="Progress Component">
        <description>Radix UI Progress for progress bars</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/ui/progress.tsx</location>
        <example><![CDATA[
import { Progress } from '@/components/ui/progress'

<Progress value={50} className="h-2" indicatorClassName="bg-primary" />
        ]]></example>
      </pattern>

      <pattern name="Badge Component">
        <description>shadcn/ui Badge for status indicators</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/ui/badge.tsx</location>
        <example><![CDATA[
import { Badge } from '@/components/ui/badge'

<Badge variant="default">Status</Badge>
        ]]></example>
      </pattern>
    </ui-patterns>

    <state-management>
      <pattern name="Zustand Store with Persistence">
        <description>Zustand store with persist middleware for localStorage</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/stores/ui.ts</location>
        <example><![CDATA[
import { create } from 'zustand'
import { persist } from 'zustand/middleware'

interface OnboardingWizardStore {
  currentStep: number
  hasDocuments: boolean | null
  businessName: string
  businessDescription: string
  problemStatement: string
  targetCustomer: string
  proposedSolution: string

  setCurrentStep: (step: number) => void
  setHasDocuments: (hasDocuments: boolean) => void
  setBusinessName: (name: string) => void
  setBusinessDescription: (description: string) => void
  setProblemStatement: (problem: string) => void
  setTargetCustomer: (customer: string) => void
  setProposedSolution: (solution: string) => void
  reset: () => void
}

export const useOnboardingWizardStore = create<OnboardingWizardStore>()(
  persist(
    (set) => ({
      currentStep: 1,
      hasDocuments: null,
      businessName: '',
      businessDescription: '',
      problemStatement: '',
      targetCustomer: '',
      proposedSolution: '',

      setCurrentStep: (step) => set({ currentStep: step }),
      setHasDocuments: (hasDocuments) => set({ hasDocuments }),
      setBusinessName: (businessName) => set({ businessName }),
      setBusinessDescription: (businessDescription) => set({ businessDescription }),
      setProblemStatement: (problemStatement) => set({ problemStatement }),
      setTargetCustomer: (targetCustomer) => set({ targetCustomer }),
      setProposedSolution: (proposedSolution) => set({ proposedSolution }),
      reset: () => set({
        currentStep: 1,
        hasDocuments: null,
        businessName: '',
        businessDescription: '',
        problemStatement: '',
        targetCustomer: '',
        proposedSolution: '',
      }),
    }),
    {
      name: 'onboarding-wizard',
      partialize: (state) => ({
        currentStep: state.currentStep,
        hasDocuments: state.hasDocuments,
        businessName: state.businessName,
        businessDescription: state.businessDescription,
        problemStatement: state.problemStatement,
        targetCustomer: state.targetCustomer,
        proposedSolution: state.proposedSolution,
      }),
    }
  )
)
        ]]></example>
      </pattern>
    </state-management>

    <validation>
      <pattern name="Zod Schema Validation">
        <description>Zod schemas for form validation with react-hook-form</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/lib/validations/auth.ts</location>
        <example><![CDATA[
import { z } from 'zod'

export const businessDetailsSchema = z.object({
  name: z
    .string()
    .min(3, 'Business name must be at least 3 characters')
    .max(100, 'Business name must not exceed 100 characters')
    .regex(/^[a-zA-Z0-9\s-]+$/, 'Business name can only contain letters, numbers, spaces, and hyphens'),
  description: z
    .string()
    .min(10, 'Description must be at least 10 characters')
    .max(500, 'Description must not exceed 500 characters'),
})

export const businessIdeaSchema = z.object({
  problemStatement: z
    .string()
    .min(10, 'Problem statement must be at least 10 characters')
    .max(300, 'Problem statement must not exceed 300 characters'),
  targetCustomer: z
    .string()
    .min(5, 'Target customer must be at least 5 characters')
    .max(200, 'Target customer must not exceed 200 characters'),
  proposedSolution: z
    .string()
    .min(10, 'Proposed solution must be at least 10 characters')
    .max(300, 'Proposed solution must not exceed 300 characters'),
})

export type BusinessDetailsFormData = z.infer<typeof businessDetailsSchema>
export type BusinessIdeaFormData = z.infer<typeof businessIdeaSchema>
        ]]></example>
      </pattern>

      <pattern name="React Hook Form with Zod">
        <description>Form handling with react-hook-form and Zod validation</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/auth/sign-up-form.tsx</location>
        <example><![CDATA[
'use client'

import { useForm } from 'react-hook-form'
import { standardSchemaResolver } from '@hookform/resolvers/standard-schema'

const {
  register,
  handleSubmit,
  watch,
  formState: { errors },
} = useForm<BusinessDetailsFormData>({
  resolver: standardSchemaResolver(businessDetailsSchema),
  mode: 'onBlur',
})

const onSubmit = async (data: BusinessDetailsFormData) => {
  // Handle form submission
}

// In render:
<form onSubmit={handleSubmit(onSubmit)}>
  <div className="space-y-2">
    <Label htmlFor="name">Business Name</Label>
    <Input
      id="name"
      type="text"
      {...register('name')}
      disabled={isSubmitting}
      aria-invalid={errors.name ? 'true' : 'false'}
    />
    {errors.name && (
      <p className="text-sm text-red-600">{errors.name.message}</p>
    )}
  </div>
</form>
        ]]></example>
      </pattern>
    </validation>

    <api-patterns>
      <pattern name="Next.js API Route">
        <description>API route with authentication and error handling</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/app/api/businesses/route.ts</location>
        <example><![CDATA[
import { NextResponse } from 'next/server'
import { prisma } from '@hyvve/db'
import { getSession } from '@/lib/auth-server'

export async function POST(req: Request) {
  try {
    const session = await getSession()

    if (!session?.user?.id) {
      return NextResponse.json(
        { success: false, error: 'UNAUTHORIZED', message: 'You must be signed in' },
        { status: 401 }
      )
    }

    const workspaceId = session.session.activeWorkspaceId

    if (!workspaceId) {
      return NextResponse.json(
        { success: false, error: 'NO_WORKSPACE', message: 'No active workspace selected' },
        { status: 400 }
      )
    }

    const body = await req.json()

    // Validate with Zod
    const validation = businessCreateSchema.safeParse(body)
    if (!validation.success) {
      return NextResponse.json(
        { success: false, error: 'VALIDATION_ERROR', details: validation.error.errors },
        { status: 400 }
      )
    }

    // Create business
    const business = await prisma.business.create({
      data: {
        workspaceId,
        userId: session.user.id,
        name: body.name,
        description: body.description,
        stage: 'IDEA',
        onboardingStatus: body.hasDocuments ? 'WIZARD' : 'VALIDATION',
      },
    })

    return NextResponse.json({ success: true, data: business }, { status: 201 })
  } catch (error) {
    console.error('Error creating business:', error)
    return NextResponse.json(
      { success: false, error: 'INTERNAL_ERROR', message: 'An error occurred' },
      { status: 500 }
    )
  }
}
        ]]></example>
      </pattern>
    </api-patterns>

    <routing>
      <pattern name="Next.js App Router Navigation">
        <description>Client-side navigation with useRouter and useSearchParams</description>
        <example><![CDATA[
'use client'

import { useRouter, useSearchParams } from 'next/navigation'

const router = useRouter()
const searchParams = useSearchParams()

// Get current step from URL
const step = parseInt(searchParams.get('step') || '1')

// Navigate to step
const goToStep = (step: number) => {
  router.push(`/onboarding/wizard?step=${step}`)
}

// Navigate after business creation
router.push(`/dashboard/${businessId}/validation`)
        ]]></example>
      </pattern>
    </routing>

    <utility-functions>
      <pattern name="cn() - Class Name Utility">
        <description>Utility for merging Tailwind classes</description>
        <location>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/lib/utils.ts</location>
        <example><![CDATA[
import { cn } from '@/lib/utils'

<div className={cn(
  "base-class",
  isActive && "active-class",
  "conditional-class"
)} />
        ]]></example>
      </pattern>
    </utility-functions>

    <icons>
      <pattern name="Lucide React Icons">
        <description>Icon library used throughout the application</description>
        <example><![CDATA[
import { FileText, Sparkles, ArrowRight, ArrowLeft, Check, Loader2, Rocket } from 'lucide-react'

<FileText className="mb-4 h-12 w-12 text-primary" />
<ArrowRight className="ml-2 h-4 w-4" />
        ]]></example>
      </pattern>
    </icons>
  </existing-patterns>

  <implementation-steps>
    <step number="1">
      <title>Create Validation Schemas</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/lib/validations/onboarding.ts</file>
      <actions>
        <action>Create businessDetailsSchema (name, description)</action>
        <action>Create businessIdeaSchema (problemStatement, targetCustomer, proposedSolution)</action>
        <action>Create businessCreateSchema for API validation</action>
        <action>Export TypeScript types from schemas</action>
      </actions>
    </step>

    <step number="2">
      <title>Create Zustand Store</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/stores/onboarding-wizard-store.ts</file>
      <actions>
        <action>Create OnboardingWizardStore interface</action>
        <action>Implement store with persist middleware</action>
        <action>Add state for currentStep, hasDocuments, and all form fields</action>
        <action>Add setter functions for each field</action>
        <action>Add reset() function to clear state</action>
        <action>Configure partialize to exclude temporary state</action>
        <action>Set localStorage key: 'onboarding-wizard'</action>
      </actions>
    </step>

    <step number="3">
      <title>Create WizardProgress Component</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardProgress.tsx</file>
      <actions>
        <action>Create component with currentStep, totalSteps, stepLabels props</action>
        <action>Render step indicator: "Step X of Y"</action>
        <action>Render progress bar (0-100%)</action>
        <action>Render stepper with 4 steps: Choice, Details, Idea, Launch</action>
        <action>Show checkmark for completed steps, number for current/upcoming</action>
        <action>Add optional onStepClick for navigation to completed steps</action>
      </actions>
    </step>

    <step number="4">
      <title>Create WizardStepChoice Component (Step 1)</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardStepChoice.tsx</file>
      <actions>
        <action>Create component with onContinue prop</action>
        <action>Render two option cards: "I have documents" and "Start from scratch"</action>
        <action>Use FileText and Sparkles icons from lucide-react</action>
        <action>Add selected state highlighting (border-primary, bg-primary/5)</action>
        <action>Add hover states</action>
        <action>Enable Continue button only when option selected</action>
        <action>Call onContinue(hasDocuments) on Continue click</action>
      </actions>
    </step>

    <step number="5">
      <title>Create WizardStepDetails Component (Step 2)</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardStepDetails.tsx</file>
      <actions>
        <action>Create component with onContinue, onBack, initialData props</action>
        <action>Set up react-hook-form with businessDetailsSchema</action>
        <action>Render name input with validation</action>
        <action>Render description textarea with validation and character count</action>
        <action>Use watch() to track description length</action>
        <action>Display character count: "X/500 characters"</action>
        <action>Add Back button (calls onBack)</action>
        <action>Add Continue button (validates and calls onContinue)</action>
      </actions>
    </step>

    <step number="6">
      <title>Create WizardStepIdea Component (Step 3)</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardStepIdea.tsx</file>
      <actions>
        <action>Create component with onContinue, onBack, initialData props</action>
        <action>Set up react-hook-form with businessIdeaSchema</action>
        <action>Render problemStatement textarea with helper text and character count</action>
        <action>Render targetCustomer input with helper text and character count</action>
        <action>Render proposedSolution textarea with helper text and character count</action>
        <action>Add helper text for each field (examples from story)</action>
        <action>Add Back and Continue buttons</action>
      </actions>
    </step>

    <step number="7">
      <title>Create WizardStepConfirm Component (Step 4)</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardStepConfirm.tsx</file>
      <actions>
        <action>Create component with wizardData, onLaunch, onBack, onEdit props</action>
        <action>Render summary cards for: Starting Method, Business Details, Business Idea</action>
        <action>Add Edit button to each card (calls onEdit with step number)</action>
        <action>Add Back button</action>
        <action>Add "Launch Business" button with Rocket icon</action>
        <action>Show loading state during business creation (Loader2 icon)</action>
        <action>Handle error state with retry option</action>
      </actions>
    </step>

    <step number="8">
      <title>Create Main Wizard Page</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/app/(onboarding)/onboarding/wizard/page.tsx</file>
      <actions>
        <action>Create wizard orchestrator component</action>
        <action>Use useOnboardingWizardStore for state management</action>
        <action>Use useSearchParams to sync step with URL</action>
        <action>Render WizardProgress at top</action>
        <action>Conditionally render step components based on currentStep</action>
        <action>Implement handleContinue for each step (save to store, navigate to next)</action>
        <action>Implement handleBack (navigate to previous step)</action>
        <action>Implement handleEdit (jump to specific step)</action>
        <action>Implement handleLaunch (create business via API)</action>
        <action>Navigate to /onboarding/documents or /dashboard/[id]/validation on success</action>
      </actions>
    </step>

    <step number="9">
      <title>Create/Update Business API Route</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/app/api/businesses/route.ts</file>
      <actions>
        <action>Add POST handler to existing GET handler</action>
        <action>Validate request body with businessCreateSchema</action>
        <action>Get session and workspaceId</action>
        <action>Create Business record with Prisma</action>
        <action>Create ValidationSession record with ideaDescription</action>
        <action>Set onboardingStatus based on hasDocuments</action>
        <action>Return created business with status 201</action>
        <action>Handle errors with appropriate status codes</action>
      </actions>
    </step>

    <step number="10">
      <title>Create Onboarding Layout (if needed)</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/app/(onboarding)/layout.tsx</file>
      <actions>
        <action>Create simple centered layout for onboarding pages</action>
        <action>Add HYVVE logo/branding</action>
        <action>Remove dashboard sidebar/header</action>
        <action>Max width container with padding</action>
      </actions>
    </step>

    <step number="11">
      <title>Update Sprint Status</title>
      <file>/home/chris/projects/work/Ai Bussiness Hub/docs/sprint-artifacts/sprint-status.yaml</file>
      <actions>
        <action>Change 08-3-implement-onboarding-wizard-ui: drafted → ready-for-dev</action>
      </actions>
    </step>
  </implementation-steps>

  <file-paths>
    <files-to-create>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/lib/validations/onboarding.ts</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/stores/onboarding-wizard-store.ts</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardProgress.tsx</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardStepChoice.tsx</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardStepDetails.tsx</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardStepIdea.tsx</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/components/onboarding/WizardStepConfirm.tsx</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/app/(onboarding)/onboarding/wizard/page.tsx</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/app/(onboarding)/layout.tsx</file>
    </files-to-create>

    <files-to-modify>
      <file>/home/chris/projects/work/Ai Bussiness Hub/apps/web/src/app/api/businesses/route.ts</file>
      <file>/home/chris/projects/work/Ai Bussiness Hub/docs/sprint-artifacts/sprint-status.yaml</file>
    </files-to-modify>
  </file-paths>

  <technical-notes>
    <note category="Tailwind CSS">
      <title>Dynamic Classes Limitation</title>
      <description>
        Tailwind's JIT compiler needs complete class strings in source. Avoid dynamic string construction.
        Use conditional full class strings or inline styles for truly dynamic values.
      </description>
      <example><![CDATA[
// ❌ WRONG
className={`ml-${collapsed ? '16' : '64'}`}

// ✅ CORRECT
className={collapsed ? 'ml-16' : 'ml-64'}

// ✅ CORRECT for dynamic values
style={{ marginLeft: collapsed ? 64 : 256 }}
      ]]></example>
    </note>

    <note category="State Persistence">
      <title>Zustand Persist Middleware</title>
      <description>
        Use partialize to exclude temporary UI state. State expires after 7 days.
        Check timestamp on load to clear expired state.
      </description>
    </note>

    <note category="Form Validation">
      <title>Real-time Validation</title>
      <description>
        Use mode: 'onBlur' for react-hook-form to validate on blur.
        Use watch() to track character counts for real-time updates.
      </description>
    </note>

    <note category="URL State">
      <title>Sync URL with Wizard State</title>
      <description>
        Use useSearchParams() to read current step from URL.
        Update URL when step changes for deep linking and browser back/forward support.
      </description>
    </note>

    <note category="Accessibility">
      <title>ARIA Labels and Keyboard Navigation</title>
      <description>
        - All form fields have proper labels
        - Error messages linked with aria-describedby
        - Option cards keyboard navigable with Enter/Space
        - Progress stepper uses semantic list markup
      </description>
    </note>

    <note category="Performance">
      <title>Optimization Strategies</title>
      <description>
        - Lazy load step components with React.lazy if needed
        - Debounce character count updates if performance issues
        - Prevent duplicate API calls with loading state
      </description>
    </note>

    <note category="Error Handling">
      <title>API Error States</title>
      <description>
        Handle specific error cases:
        - 401: Redirect to sign-in
        - 400: Display validation errors
        - 500: Show retry option
        - Network errors: Check connection message
      </description>
    </note>
  </technical-notes>

  <design-considerations>
    <consideration>
      <title>Mobile Responsiveness</title>
      <description>
        Wizard should work on mobile (320px+), tablet (768px+), and desktop (1024px+).
        Use responsive grid for option cards: 1 column mobile, 2 columns tablet+.
      </description>
    </consideration>

    <consideration>
      <title>Visual Consistency</title>
      <description>
        Follow Epic 07 UI patterns: same color scheme, spacing, typography.
        Use existing Card, Button, Input components - no custom styles unless necessary.
      </description>
    </consideration>

    <consideration>
      <title>Loading States</title>
      <description>
        Use Loader2 icon with animate-spin for all loading states.
        Disable buttons during loading to prevent duplicate submissions.
      </description>
    </consideration>

    <consideration>
      <title>Character Counts</title>
      <description>
        Display as "X/MAX characters" below textarea/input.
        Update in real-time using watch() from react-hook-form.
        Change color when approaching limit (e.g., text-yellow-600 at 90%, text-red-600 at 100%).
      </description>
    </consideration>
  </design-considerations>

  <testing-notes>
    <test-case id="TC-1">
      <title>Complete Wizard Flow</title>
      <steps>
        <step>Navigate to /onboarding/wizard</step>
        <step>Select "Start from scratch"</step>
        <step>Enter business name and description</step>
        <step>Enter problem, target customer, solution</step>
        <step>Review summary</step>
        <step>Click "Launch Business"</step>
        <step>Verify navigation to /dashboard/[id]/validation</step>
      </steps>
    </test-case>

    <test-case id="TC-2">
      <title>Back Navigation Preserves Data</title>
      <steps>
        <step>Complete Step 1 and Step 2</step>
        <step>Click Back on Step 3</step>
        <step>Verify Step 2 still has entered data</step>
        <step>Click Back again</step>
        <step>Verify Step 1 still has selection</step>
      </steps>
    </test-case>

    <test-case id="TC-3">
      <title>Resume After Abandonment</title>
      <steps>
        <step>Start wizard, complete Step 2</step>
        <step>Close tab/browser</step>
        <step>Return to /onboarding/wizard</step>
        <step>Verify wizard resumes at Step 2 with data preserved</step>
      </steps>
    </test-case>

    <test-case id="TC-4">
      <title>Form Validation</title>
      <steps>
        <step>Try to continue Step 2 with empty name</step>
        <step>Verify error message displays</step>
        <step>Enter name with special characters</step>
        <step>Verify regex validation error</step>
        <step>Enter valid name and description</step>
        <step>Verify Continue button works</step>
      </steps>
    </test-case>

    <test-case id="TC-5">
      <title>Edit from Confirmation Step</title>
      <steps>
        <step>Complete all steps to Step 4</step>
        <step>Click Edit on Business Details</step>
        <step>Verify navigation to Step 2 with data</step>
        <step>Modify description</step>
        <step>Navigate back to Step 4</step>
        <step>Verify updated description in summary</step>
      </steps>
    </test-case>

    <test-case id="TC-6">
      <title>API Error Handling</title>
      <steps>
        <step>Mock API failure on business creation</step>
        <step>Complete wizard and click Launch</step>
        <step>Verify error message displays</step>
        <step>Verify retry button is available</step>
        <step>Click retry</step>
        <step>Verify API call is made again</step>
      </steps>
    </test-case>
  </testing-notes>

  <references>
    <reference type="story-file">/home/chris/projects/work/Ai Bussiness Hub/docs/stories/story-08-3-implement-onboarding-wizard-ui.md</reference>
    <reference type="tech-spec">/home/chris/projects/work/Ai Bussiness Hub/docs/sprint-artifacts/tech-spec-epic-08.md</reference>
    <reference type="epic">/home/chris/projects/work/Ai Bussiness Hub/docs/epics/EPIC-08-business-onboarding.md</reference>
    <reference type="dependency">Story 08.1 - Business database models</reference>
    <reference type="dependency">Story 08.2 - Portfolio dashboard</reference>
    <reference type="ui-pattern">Epic 07 - UI Shell components</reference>
  </references>
</story-context>
