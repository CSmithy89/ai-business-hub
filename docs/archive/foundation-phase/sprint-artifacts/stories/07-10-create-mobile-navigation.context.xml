<?xml version="1.0" encoding="UTF-8"?>
<story-context>
  <story-metadata>
    <story-id>07-10-create-mobile-navigation</story-id>
    <epic-id>EPIC-07</epic-id>
    <epic-name>UI Shell</epic-name>
    <story-title>Create Mobile Navigation</story-title>
    <story-points>2</story-points>
    <status>done</status>
    <created-date>2025-12-04</created-date>
    <completed-date>2025-12-04</completed-date>
  </story-metadata>

  <story-description>
    Implement mobile-responsive navigation for the HYVVE platform with hamburger menu,
    slide-out drawer navigation, and bottom navigation bar. Provides touch-optimized
    experience for mobile users with 44x44px minimum touch targets.
  </story-description>

  <technical-context>
    <tech-spec-reference>
      <file-path>/docs/archive/foundation-phase/sprint-artifacts/tech-spec-epic-07.md</file-path>
      <relevant-sections>
        <section>AC-07.10: Mobile Navigation</section>
        <section>Component Structure - mobile-nav.tsx</section>
        <section>Responsive Breakpoints</section>
      </relevant-sections>
    </tech-spec-reference>

    <wireframe-references>
      <wireframe>
        <id>SH-06</id>
        <name>Mobile Layout</name>
        <path>/docs/design/wireframes/Finished wireframes and html files/sh-06_mobile_layout/code.html</path>
      </wireframe>
    </wireframe-references>

    <architecture-decisions>
      <decision>
        <title>Use shadcn Sheet for Mobile Drawer</title>
        <rationale>
          Sheet component provides accessible, animated drawer with overlay
          and proper focus management. Based on Radix UI Dialog primitive.
        </rationale>
      </decision>
      <decision>
        <title>Bottom Nav with 4 Items</title>
        <rationale>
          Industry standard for mobile apps. Provides quick access to key sections:
          Home, Approvals (with badge), Chat (toggle), and More (drawer).
        </rationale>
      </decision>
      <decision>
        <title>56px Touch Targets in Bottom Nav</title>
        <rationale>
          Exceeds WCAG minimum of 44x44px for comfortable thumb tapping.
          Improves usability on all screen sizes.
        </rationale>
      </decision>
    </architecture-decisions>
  </technical-context>

  <implementation-summary>
    <components-created>
      <component>
        <name>MobileHamburger</name>
        <path>/apps/web/src/components/mobile/MobileHamburger.tsx</path>
        <purpose>Hamburger menu button in header (mobile only)</purpose>
        <key-features>
          <feature>Toggles mobile drawer open/close</feature>
          <feature>Shows menu/close icon based on state</feature>
          <feature>Hidden on desktop (md: breakpoint)</feature>
        </key-features>
      </component>

      <component>
        <name>MobileDrawer</name>
        <path>/apps/web/src/components/mobile/MobileDrawer.tsx</path>
        <purpose>Slide-out drawer navigation for mobile</purpose>
        <key-features>
          <feature>User profile section with avatar and email</feature>
          <feature>Navigation items with active state highlighting</feature>
          <feature>Badge support for approval count</feature>
          <feature>Theme toggle section</feature>
          <feature>Sign out button</feature>
          <feature>Touch-friendly 44px minimum height</feature>
        </key-features>
      </component>

      <component>
        <name>MobileBottomNav</name>
        <path>/apps/web/src/components/mobile/MobileBottomNav.tsx</path>
        <purpose>Fixed bottom navigation bar for mobile</purpose>
        <key-features>
          <feature>4 navigation items: Home, Approvals, Chat, More</feature>
          <feature>Active indicator line under current section</feature>
          <feature>Badge for approval count</feature>
          <feature>56px minimum touch targets</feature>
          <feature>Material Symbols icons</feature>
        </key-features>
      </component>

      <component>
        <name>Sheet</name>
        <path>/apps/web/src/components/ui/sheet.tsx</path>
        <purpose>shadcn/ui Sheet component for drawer</purpose>
        <key-features>
          <feature>Radix UI Dialog-based drawer</feature>
          <feature>Supports left/right/top/bottom directions</feature>
          <feature>Overlay backdrop with blur</feature>
          <feature>Smooth slide animations</feature>
        </key-features>
      </component>

      <component>
        <name>index</name>
        <path>/apps/web/src/components/mobile/index.ts</path>
        <purpose>Barrel export for mobile components</purpose>
      </component>
    </components-created>

    <files-modified>
      <file>
        <path>/apps/web/src/components/shell/Header.tsx</path>
        <changes>
          <change>Added MobileHamburger component import and render</change>
        </changes>
      </file>

      <file>
        <path>/apps/web/src/app/(dashboard)/layout.tsx</path>
        <changes>
          <change>Added MobileDrawer component</change>
          <change>Added MobileBottomNav component</change>
        </changes>
      </file>

      <file>
        <path>/apps/web/src/stores/ui.ts</path>
        <changes>
          <change>Added openMobileMenu() method</change>
          <change>Added closeMobileMenu() method</change>
        </changes>
      </file>

      <file>
        <path>/docs/archive/foundation-phase/sprint-artifacts/sprint-status.yaml</path>
        <changes>
          <change>Updated 07-10-create-mobile-navigation to done</change>
        </changes>
      </file>
    </files-modified>
  </implementation-summary>

  <responsive-behavior>
    <mobile-view breakpoint="&lt; 768px">
      <feature>Hamburger button visible in header</feature>
      <feature>Desktop sidebar hidden</feature>
      <feature>Mobile drawer slides over content</feature>
      <feature>Bottom navigation bar visible and fixed</feature>
      <feature>Chat opens as overlay</feature>
    </mobile-view>

    <desktop-view breakpoint="â‰¥ 768px">
      <feature>Hamburger button hidden</feature>
      <feature>Desktop sidebar visible</feature>
      <feature>Mobile drawer not accessible</feature>
      <feature>Bottom navigation bar hidden</feature>
      <feature>Chat panel in right sidebar</feature>
    </desktop-view>
  </responsive-behavior>

  <navigation-structure>
    <drawer-items>
      <item href="/dashboard" icon="grid_view">Dashboard</item>
      <item href="/dashboard/approvals" icon="check_circle" badge="approval-count">Approvals</item>
      <item href="/dashboard/agents" icon="smart_toy">AI Team</item>
      <item href="/dashboard/settings" icon="settings">Settings</item>
    </drawer-items>

    <bottom-nav-items>
      <item href="/dashboard" icon="home">Home</item>
      <item href="/dashboard/approvals" icon="task_alt" badge="approval-count">Approvals</item>
      <item action="toggleChat" icon="chat">Chat</item>
      <item action="openDrawer" icon="more_horiz">More</item>
    </bottom-nav-items>
  </navigation-structure>

  <design-tokens>
    <colors>
      <token name="color-bg-primary">Primary background</token>
      <token name="color-bg-secondary">Secondary/elevated background</token>
      <token name="color-bg-tertiary">Tertiary background</token>
      <token name="color-bg-hover">Hover state background</token>
      <token name="color-text-primary">Primary text</token>
      <token name="color-text-secondary">Secondary/muted text</token>
      <token name="color-border-default">Border color</token>
      <token name="color-primary">Brand primary (links, active states)</token>
      <token name="color-error">Error/destructive actions</token>
      <token name="color-info">Info accent</token>
    </colors>

    <spacing>
      <dimension name="touch-target-min">44px (WCAG minimum)</dimension>
      <dimension name="touch-target-comfortable">56px (bottom nav)</dimension>
      <dimension name="padding-vertical">py-3 (12px)</dimension>
      <dimension name="padding-horizontal">px-4 (16px)</dimension>
    </spacing>

    <animations>
      <transition name="duration-300">300ms for drawer/overlay</transition>
      <easing name="ease-in-out">Standard easing</easing>
    </animations>
  </design-tokens>

  <accessibility-features>
    <feature>Touch targets minimum 44x44px (WCAG 2.1 AA)</feature>
    <feature>ARIA labels on all interactive elements</feature>
    <feature>Semantic HTML for navigation</feature>
    <feature>Focus indicators on focusable elements</feature>
    <feature>Screen reader support</feature>
    <feature>Color contrast meets WCAG AA standards</feature>
    <feature>aria-expanded on hamburger button</feature>
    <feature>aria-current on active navigation items</feature>
  </accessibility-features>

  <state-management>
    <zustand-store>
      <state-property>mobileMenuOpen: boolean</state-property>
      <action>toggleMobileMenu()</action>
      <action>openMobileMenu()</action>
      <action>closeMobileMenu()</action>
    </zustand-store>

    <integration>
      <hook>useUIStore() - Access mobile menu state</hook>
      <hook>useApprovalCount() - Get approval badge count</hook>
      <hook>usePathname() - Determine active route</hook>
      <hook>useRouter() - Navigate programmatically</hook>
    </integration>
  </state-management>

  <dependencies>
    <internal-dependencies>
      <dependency>Epic 07 Stories 07-1 through 07-9</dependency>
      <dependency>UI Store (Zustand) with mobile state</dependency>
      <dependency>Design tokens in globals.css</dependency>
      <dependency>Material Symbols icons</dependency>
    </internal-dependencies>

    <external-dependencies>
      <package name="@radix-ui/react-dialog" version="latest">Sheet primitive</package>
      <package name="zustand" version="^4.5.0">State management</package>
      <package name="tailwindcss" version="^4.x">Responsive utilities</package>
    </external-dependencies>
  </dependencies>

  <testing-strategy>
    <manual-testing>
      <test>Hamburger button appears only on mobile</test>
      <test>Drawer slides in smoothly</test>
      <test>Drawer closes on overlay click</test>
      <test>Navigation items highlight active route</test>
      <test>Approval badge displays correct count</test>
      <test>Bottom nav items navigate correctly</test>
      <test>Chat toggle works from bottom nav</test>
      <test>More button opens drawer</test>
      <test>All touch targets are easily tappable</test>
      <test>Components hidden on desktop</test>
    </manual-testing>

    <accessibility-testing>
      <test>Touch targets meet 44x44px minimum</test>
      <test>Screen reader announces navigation</test>
      <test>Focus indicators visible</test>
      <test>Color contrast meets WCAG AA</test>
      <test>No keyboard traps</test>
    </accessibility-testing>

    <browser-testing>
      <browser>Chrome Mobile</browser>
      <browser>Safari iOS</browser>
      <browser>Firefox Android</browser>
      <browser>Samsung Internet</browser>
    </browser-testing>
  </testing-strategy>

  <future-enhancements>
    <enhancement>
      <title>Swipe Gestures</title>
      <description>Add swipe to open/close drawer on mobile</description>
      <priority>Low</priority>
    </enhancement>
    <enhancement>
      <title>Bottom Nav Auto-Hide</title>
      <description>Hide bottom nav on scroll down, show on scroll up</description>
      <priority>Medium</priority>
    </enhancement>
    <enhancement>
      <title>Fullscreen Chat on Mobile</title>
      <description>Open chat as fullscreen overlay on mobile devices</description>
      <priority>Medium</priority>
    </enhancement>
    <enhancement>
      <title>Theme Toggle Integration</title>
      <description>Wire up theme toggle in drawer to ThemeProvider</description>
      <priority>High (next story)</priority>
    </enhancement>
  </future-enhancements>

  <related-documentation>
    <document>
      <title>Epic 07 Technical Specification</title>
      <path>/docs/archive/foundation-phase/sprint-artifacts/tech-spec-epic-07.md</path>
    </document>
    <document>
      <title>UX Design Document - Mobile Patterns</title>
      <path>/docs/ux-design.md</path>
    </document>
    <document>
      <title>Style Guide</title>
      <path>/docs/style-guide.md</path>
    </document>
    <document>
      <title>Wireframe SH-06: Mobile Layout</title>
      <path>/docs/design/wireframes/Finished wireframes and html files/sh-06_mobile_layout/code.html</path>
    </document>
  </related-documentation>

  <notes>
    <note>Theme toggle UI added but not fully wired (needs ThemeProvider integration)</note>
    <note>User profile uses mock data - will integrate with auth session in future</note>
    <note>Swipe gestures deferred as optional enhancement</note>
    <note>Bottom nav scroll behavior deferred</note>
    <note>All core functionality implemented and tested</note>
  </notes>
</story-context>
