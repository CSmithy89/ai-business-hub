# ============================================
# DATABASE (Story 00.4)
# ============================================
# Supabase connection pooler URL (PgBouncer session mode for RLS)
DATABASE_URL="postgresql://user:password@host:6543/database?pgbouncer=true"
# Direct connection for migrations (bypasses pooler)
DIRECT_URL="postgresql://user:password@host:5432/database"

# ============================================
# REDIS (Story 00.5)
# ============================================
# Standard Redis connection for event bus, queues, and local dev rate limiting
REDIS_URL="redis://localhost:6379"

# ============================================
# UPSTASH REDIS (Story 10.1)
# ============================================
# Distributed rate limiting via Upstash Redis REST API
# Used for production-grade rate limiting across serverless deployments
#
# Setup Instructions:
# 1. Create free account at https://console.upstash.com
# 2. Create new Redis database (select region closest to your app)
# 3. Copy "REST URL" and "REST Token" from database details page
# 4. Paste values below
#
# Fallback Behavior:
# - If not configured, system falls back to in-memory rate limiting
# - In-memory is NOT production-ready (lost on server restart)
# - Always configure for production deployments
#
UPSTASH_REDIS_REST_URL="https://your-database.upstash.io"
UPSTASH_REDIS_REST_TOKEN="your-rest-token-here"

# ============================================
# AUTHENTICATION (Epic 01)
# ============================================
# BETTER_AUTH_SECRET is used for:
# - JWT token signing
# - Session encryption
# - 2FA TOTP secret encryption (via encryptSecret/decryptSecret)
#
# Security Requirements (Story 10.2):
# - Minimum 32 characters (64+ recommended for production)
# - High entropy (random, not predictable patterns)
# - Minimum 128 bits total entropy
# - Never commit actual secret to git
#
# Generate a secure secret with:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# OR
# openssl rand -base64 48
#
# Weak keys are REJECTED in production:
# - Keys shorter than 32 characters
# - Keys with low entropy (< 128 bits)
# - Keys with repeated/sequential patterns (aaaa..., 1234...)
#
# See docs/DEPLOYMENT.md for production deployment guidelines
#
BETTER_AUTH_SECRET="generate-with-openssl-rand-base64-48"
BETTER_AUTH_URL="http://localhost:3000"
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""

# ============================================
# CSRF PROTECTION (Story 10.6)
# ============================================
# Optional: Separate secret for CSRF token generation
# If not set, falls back to BETTER_AUTH_SECRET
# Having a separate secret provides additional security isolation
#
# Generate with:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# Leave empty to use BETTER_AUTH_SECRET (recommended for simplicity)
#
CSRF_SECRET=""

# Enable CSRF double-submit protection for cookie-authenticated requests
# ONLY required if using cookie-based authentication (session cookies).
# If using pure Bearer token auth, this can remain false.
CSRF_ENABLED="false"
# Cookie name used to store the CSRF token issued by the /csrf endpoint
CSRF_COOKIE_NAME="hyvve_csrf_token"
# Header expected on state-changing requests
CSRF_HEADER_NAME="x-csrf-token"
# Session cookie name used to detect cookie-authenticated requests
CSRF_SESSION_COOKIE_NAME="hyvve.session_token"
# Cookie flags for CSRF token cookie
# Note: If SameSite is "none", Secure MUST be "true" (browser requirement)
CSRF_COOKIE_SECURE="false"
CSRF_COOKIE_SAMESITE="lax"
CSRF_COOKIE_HTTPONLY="true"

# ============================================
# AI PROVIDERS (Epic 06 - workspace-level, encrypted in DB)
# ============================================
# Master encryption key for encrypting AI provider API keys (AES-256-GCM)
# IMPORTANT: Generate a secure 32-byte key and store securely (never commit to git)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
ENCRYPTION_MASTER_KEY="generate-with-openssl-rand-base64-32"

# ============================================
# KNOWLEDGE BASE (KB-04)
# ============================================
# Max tasks scanned for KB gap analysis (clamped to 50-2000)
KB_GAP_TASK_LIMIT="500"

# ============================================
# EMAIL (Epic 01)
# ============================================
RESEND_API_KEY=""

# ============================================
# MONITORING (Future)
# ============================================
HELICONE_API_KEY=""

# ============================================
# AGENTOS (Story 00.7)
# ============================================
AGENTOS_PORT="7777"
AGENTOS_HOST="0.0.0.0"

# ============================================
# CONTROL PLANE (Story 04.11)
# ============================================
# Enable/disable Agno Control Plane monitoring (os.agno.com)
# Set to false in production for security
CONTROL_PLANE_ENABLED="true"

# Optional: API key for Control Plane authentication
# If set, Control Plane must provide this key as Authorization header
# If not set, Control Plane endpoints are public (local dev only!)
# Generate with: openssl rand -base64 32
AGNO_API_KEY=""

# ============================================
# COPILOTKIT / AG-UI (DM-01+)
# ============================================
# URL to Agno backend AG-UI endpoint (required for Dynamic Module System)
# CopilotKit provider will connect to ${NEXT_PUBLIC_AGNO_URL}/agui
# If not set, falls back to /api/copilotkit mock route for local development
NEXT_PUBLIC_AGNO_URL="http://localhost:8000"

# Optional: CopilotKit Cloud API Key (only for cloud features)
# Format: ck_... (starts with ck_)
# Not required for local development or self-hosted deployments
# NEXT_PUBLIC_COPILOTKIT_KEY="ck_..."

# ============================================
# PUBLIC ENVIRONMENT VARIABLES
# ============================================
NEXT_PUBLIC_API_URL="http://localhost:3001"
NEXT_PUBLIC_WS_URL="ws://localhost:3001"
NEXT_PUBLIC_AGENTOS_URL="http://localhost:7777"
